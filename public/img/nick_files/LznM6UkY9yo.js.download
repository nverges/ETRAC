if (self.CavalryLogger) { CavalryLogger.start_js(["ews1b"]); }

__d('VideoAutoplayControllerAbortLoadingHelper',['invariant','VideoPlayerLoggerSource','VideoPlayerExperiments','VideoPlayerAbortLoadingExperiment','getViewportDimensions','Set','Map'],(function a(b,c,d,e,f,g,h){function i(){'use strict';this.$VideoAutoplayControllerAbortLoadingHelper1=new (c('Set'))();this.$VideoAutoplayControllerAbortLoadingHelper2=new (c('Map'))();}i.prototype.maybeAbortLoading=function(){'use strict';for(var j=this.$VideoAutoplayControllerAbortLoadingHelper1,k=Array.isArray(j),l=0,j=k?j:j[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var m;if(k){if(l>=j.length)break;m=j[l++];}else{l=j.next();if(l.done)break;m=l.value;}var n=m;if(!n.isState('playing')&&typeof n.abortLoading==='function'&&i.shouldAbortLoadingVideoUnit(n))this.$VideoAutoplayControllerAbortLoadingHelper3(n);}};i.prototype.addVideoUnit=function(j){'use strict';if(!this.$VideoAutoplayControllerAbortLoadingHelper1.has(j)){this.$VideoAutoplayControllerAbortLoadingHelper1.add(j);this.$VideoAutoplayControllerAbortLoadingHelper2.set(j,{y:j.getDistanceToViewport(),timestamp:new Date().valueOf(),v:0,abortedLoading:false});}};i.prototype.removeVideoUnit=function(j){'use strict';this.$VideoAutoplayControllerAbortLoadingHelper1['delete'](j);this.$VideoAutoplayControllerAbortLoadingHelper2['delete'](j);};i.prototype.$VideoAutoplayControllerAbortLoadingHelper4=function(j){'use strict';var k=this.$VideoAutoplayControllerAbortLoadingHelper2.get(j);!!k||h(0);var l=void 0;if(k){l=k.abortedLoading;k.abortedLoading=false;}if(l&&typeof j.preload==='function')j.preload();};i.prototype.$VideoAutoplayControllerAbortLoadingHelper5=function(j){'use strict';var k=this.$VideoAutoplayControllerAbortLoadingHelper2.get(j);!!k||h(0);var l=void 0;if(k){l=k.abortedLoading;k.abortedLoading=true;}if(!l&&typeof j.abortLoading==='function')j.abortLoading();};i.prototype.$VideoAutoplayControllerAbortLoadingHelper3=function(j){'use strict';var k=c('getViewportDimensions')().height,l=1600,m=k/2,n=m+l,o=-m,p=o-l,q=this.$VideoAutoplayControllerAbortLoadingHelper2.get(j);!!q||h(0);if(!q)return;var r=j.getDistanceToViewport(),s=q.y;q.y=r;var t=r-s,u=new Date().valueOf(),v=q.timestamp;q.timestamp=u;var w=u-v,x=t/w,y=q.v;q.v=x;var z=x-y,aa=z/w;if(p<=r&&n>=r){if(q.abortedLoading)this.$VideoAutoplayControllerAbortLoadingHelper4(j);return;}var ba=500,ca=aa*ba*ba/2+ba*x+r;if(q.abortedLoading){if(r<p&&ca>p||r>n&&ca<n)this.$VideoAutoplayControllerAbortLoadingHelper4(j);}else this.$VideoAutoplayControllerAbortLoadingHelper5(j);};i.prototype.$VideoAutoplayControllerAbortLoadingHelper6=function(j){'use strict';var k=j.getVideoPlayerController();return k?k.getVideoPlayerID():null;};i.shouldAbortLoadingVideoUnit=function(j){'use strict';var k=!c('VideoPlayerExperiments').abortLoadingDecisioningLogic,l=true;if(j){if(typeof j.getIsInChannel==='function')l=j.getIsInChannel();if(typeof j.getSource==='function'&&c('VideoPlayerExperiments').abortLoadingDecisioningLogic)k=j.getSource()===c('VideoPlayerLoggerSource').TAHOE;return c('VideoPlayerAbortLoadingExperiment').canAbort&&!l&&!k;}return false;};f.exports=i;}),null);