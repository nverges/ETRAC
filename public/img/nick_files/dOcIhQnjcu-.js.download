if (self.CavalryLogger) { CavalryLogger.start_js(["E2Cou"]); }

__d('MercuryTypeaheadDataSource',['CurrentUser','DataSource','MercuryConfig','MercuryParticipantTypes','MercuryTypeaheadConstants','OrderedFriendsList','ShortProfiles','WorkModeConfig'],(function a(b,c,d,e,f,g){var h,i,j=[],k={},l={},m={},n=false,o=false;h=babelHelpers.inherits(p,c('DataSource'));i=h&&h.prototype;function p(q){'use strict';q=q||{};q.kanaNormalization=true;i.constructor.call(this,q);}p.prototype.dirty=function(){'use strict';this.$MercuryTypeaheadDataSource1=j;this.localCache=l;this.queryCache=k;this.queryIDs=m;return this;};p.prototype.bootstrap=function(){'use strict';if(n||o)return false;o=true;c('ShortProfiles').fetchAll().then(function(){this.updateBootstrapData();o=false;n=true;}.bind(this),function(){}.bind(this));return true;};p.prototype.updateBootstrapData=function(){'use strict';var q=this.getCachedShortProfileIDs(),r=c('WorkModeConfig').is_work_user?c('MercuryParticipantTypes').FB4C:c('MercuryParticipantTypes').FRIEND,s=q.map(function(t){var u=c('ShortProfiles').getNow(t),v=t==c('CurrentUser').getID()?r:u.type,w=[u.additionalName,u.alternateName].concat(u.searchTokens||[]).join(' '),x=u.name,y=null;return {uid:t,index:c('OrderedFriendsList').getActiveRank(t),text:x,subtext:y,tokens:w,localized_text:u.name,additional_text:u.additionalName,photo:u.thumbSrc,render_type:v,type:c('MercuryTypeaheadConstants').USER_TYPE};});if(s.length)this.addEntries(s);};p.prototype.query=function(q,r,s,t){'use strict';var u=r||q.length===1;return i.query.call(this,q,u,s,t);};p.prototype.getQueryData=function(q,r){'use strict';return babelHelpers['extends']({},i.getQueryData.call(this,q,r));};p.prototype.setEntry=function(q,r){'use strict';this.$MercuryTypeaheadDataSource1[q]=r;};p.prototype.getEntry=function(q){'use strict';return this.$MercuryTypeaheadDataSource1[q]||null;};p.prototype.getCachedShortProfileIDs=function(){'use strict';var q=c('ShortProfiles').getCachedProfileIDs(),r=q.filter(function(s){var t=c('ShortProfiles').getNow(s);return s==c('CurrentUser').getID()||t.type===c('MercuryParticipantTypes').FRIEND||t.type===c('MercuryParticipantTypes').FB4C||t.type===c('MercuryParticipantTypes').PAGE&&c('MercuryConfig').LinkedAgents&&c('MercuryConfig').LinkedAgents.indexOf(s.toString())>-1;});return r;};p.prototype.isBootstrapped=function(){'use strict';return n;};p.prototype.isBootstrapping=function(){'use strict';return o;};p.prototype.processEntries=function(q,r){'use strict';q=q.map(function(s){if(s.index==null&&(s.render_type===c('MercuryParticipantTypes').FRIEND||s.render_type===c('MercuryParticipantTypes').FB4C))s.index=c('OrderedFriendsList').getActiveRank(s.uid);if(s.render_type===c('MercuryParticipantTypes').PAGE&&c('MercuryConfig').LinkedAgents&&c('MercuryConfig').LinkedAgents.indexOf(s.uid.toString())>-1)s.index=1;return s;});return i.processEntries.call(this,q);};p.prototype.mergeUids=function(q,r,s,t){'use strict';var u=r.sort(function(v,w){return this.getEntry(v).index-this.getEntry(w).index;}.bind(this));return i.mergeUids.call(this,q,u,s,t);};f.exports=p;}),null);
__d('ChatTabTypeaheadDataSource',['MercuryConfig','MercuryTypeaheadConstants','MercuryTypeaheadDataSource'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('MercuryTypeaheadDataSource'));i=h&&h.prototype;function j(k){'use strict';k=k||{};k.maxResults=c('MercuryTypeaheadConstants').COMPOSER_CHATTAB_MAX;i.constructor.call(this,k);this.$ChatTabTypeaheadDataSource1=true;}j.prototype.buildData=function(k){'use strict';var l=[],m=[],n=[],o=[],p=[],q=[];k.forEach(function(s){var t=i.getEntry.call(this,s);switch(t.render_type){case c('MercuryTypeaheadConstants').FRIEND_TYPE:l.push(s);break;case c('MercuryTypeaheadConstants').THREAD_TYPE:if(this.$ChatTabTypeaheadDataSource1)m.push(s);break;case c('MercuryTypeaheadConstants').NON_FRIEND_TYPE:n.push(s);break;case c('MercuryTypeaheadConstants').FB4C_TYPE:o.push(s);break;case c('MercuryTypeaheadConstants').PAGE_TYPE:if(this.$ChatTabTypeaheadDataSource1)if(c('MercuryConfig').LinkedAgents&&c('MercuryConfig').LinkedAgents.indexOf(s.toString())>-1){q.push(s);}else p.push(s);break;default:break;}}.bind(this),this);var r=q.concat(l,o,m,p,n);return i.buildData.call(this,r);};j.prototype.query=function(k,l,m,n){'use strict';return i.query.call(this,k,l,m,n);};j.prototype.respond=function(k,l,m){'use strict';return i.respond.call(this,k,l,m);};j.prototype.setShowThreads=function(k){'use strict';this.$ChatTabTypeaheadDataSource1=k;};f.exports=j;}),null);
__d('FBRTCAvailability',['ChannelConstants','PresenceStatus'],(function a(b,c,d,e,f,g){'use strict';var h={isCallable:function i(j){var k=c('PresenceStatus').getCapabilities(j),l=c('ChannelConstants').CAPABILITY_VOIP_INTEROP;return !!(k&l);}};f.exports=h;}),null);
__d('FBRTCCallActions',['FBRTCDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({START_CALL:null}),i={Types:h,startCall:function j(k,l,m,n){c('FBRTCDispatcher').dispatch({type:h.START_CALL,peerID:k,callID:l,isCaller:m,audioOnly:n});}};f.exports=i;}),null);
__d('FBRTCConfig',['RTCSignalingExperiments'],(function a(b,c,d,e,f,g){var h=void 0,i=void 0,j=0,k={},l={setConfig:function m(n,o,p,q,r){k=n;j=o;h=q;i=r;},isVCEndpointCall:function m(){return h;},canPeerUseV2:function m(){return i;},getPeerID:function m(){return j;},statsInterpreterConfig:function m(){return {rtt_weight:2,frr_weight:800,plr_weight:500,score_threshold:1000,bad_score_count:3};},settingsEnabled:function m(){return k.enable_settings;},shouldAutoDisableVideo:function m(){return false;},unsupportedBrowserUrl:function m(){if(k.troubleshooting_urls&&k.troubleshooting_urls.unsupported_browser)return k.troubleshooting_urls.unsupported_browser;return 'https://www.facebook.com/help/211644178877843';},userMediaErrorUrl:function m(){if(k.troubleshooting_urls&&k.troubleshooting_urls.user_media_error)return k.troubleshooting_urls.user_media_error;return 'https://www.facebook.com/help/232232800134371';},userMediaPermissionErrorUrl:function m(){if(k.troubleshooting_urls&&k.troubleshooting_urls.user_media_permission_error)return k.troubleshooting_urls.user_media_permission_error;return 'https://www.facebook.com/help/232232800134371';},supportedSignalingExperiments:function m(){return c('RTCSignalingExperiments').getLocal();},isMessengerDotCom:function m(){return k.is_messenger_dot_com;},useMessengerCallUI:function m(){return k.messenger_call_ui;},shouldCreateDataChannel:function m(){return k.data_channel;},disableURLManager:function m(){return k.disable_url_manager;},useCurrentWindow:function m(){return k.use_current_window;}};f.exports=l;}),null);
__d('FBRTCStruct',[],(function a(b,c,d,e,f,g){var h=function j(k,l,m){var n,o;if(typeof k=='string'||k instanceof String){o=k;n=k;}else for(var p in k)if(Object.prototype.hasOwnProperty.call(k,p))if(p==='index'){m=k[p];}else{o=p;n=k[p];}l[o]=m;l.strNames[m]=n;};function i(j){'use strict';this.strNames=[];for(var k=0;k<j.length;k++)h(j[k],this,k);}f.exports=i;}),null);
__d('FBRTCConstants',['FBRTCStruct','keyMirror'],(function a(b,c,d,e,f,g){var h={OFFER:'offer',ANSWER:'answer',ICE_CANDIDATE:'ice_candidate',OK:'ok',PING:'ping',PING_ACK:'ping_ack',HANGUP:'hang_up',OTHER_DISMISS:'other_dismiss',MSG_ACK:'msg_ack',PRANSWER:'pranswer',ICERESTART_OFFER:'icerestart_offer',ICERESTART_ANSWER:'icerestart_answer',PCRESTART_OFFER:'pcrestart_offer',PCRESTART_ANSWER:'pcrestart_answer',SDP_UPDATE:'sdp_update',OFFER_ACK:'offer_ack',OFFER_NACK:'offer_nack',ANSWER_ACK:'answer_ack',SET_VIDEO:'set_video',VIDEO_REQUEST:'video_request',ACK:'ack'},i={CHILD_WINDOW_READY:'rtc_child_window_ready',CHILD_WINDOW_START_CALL:'rtc_child_window_start_call',CHILD_WINDOW_MESSAGE:'rtc_child_window_message'},j={DIRECT_VIDEO:'direct_video',ESCALATED:'escalated',ESCALATION_DECLINED:'escalation_declined',VOIP:'voip'},k={LL_NONE:0,LL_BASIC:1,LL_DEBUG:2,LL_WARNING:3,LL_INFO:4,LL_VERBOSE:5},l={AUDIO_ONLY:'audio_only',AUDIO_VIDEO:'audio_video',SCREEN_CONTENT:'screen'},m=c('keyMirror')({NO_VIDEO:null,LQ_VIDEO:null,SD_VIDEO:null,HD_VIDEO:null,FHD_VIDEO:null,CUSTOM_VIDEO:null,CUSTOM_VIDEO_STREAM_SIZE:null}),n=new (c('FBRTCStruct'))([{IGNORE_CALL:'IgnoreCall'},{HANGUP_CALL:'HangupCall'},{IN_ANOTHER_CALL:'InAnotherCall'},{ACCEPT_AFTER_HANGUP:'CallEndAcceptAfterHangUp'},{NO_ANSWER_TIMEOUT:'NoAnswerTimeout'},{INCOMING_TIMEOUT:'IncomingTimeout'},{OTHER_INSTANCE_HANDLED:'OtherInstanceHandled'},{SIGNALING_MESSAGE_FAILED:'SignalingMessageFailed'},{CONNECTION_DROPPED:'ConnectionDropped'},{CLIENT_INTERRUPTED:'ClientInterrupted'},{WEBRTC_ERROR:'WebRTCError'},{CLIENT_ERROR:'ClientError'},{NO_PERMISSION:'NoPermission'},{OTHER_NOT_CAPABLE:'OtherNotCapable'},{NO_UI_ERROR:'NoUIShown'},{UNSUPPORTED_VERSION:'VersionUnsupported'},{CALLER_NOT_VISIBLE:'CallerNotVisible'},{CARRIER_BLOCKED:'CarrierBlocked'},{OTHER_CARRIER_BLOCKED:'OtherCarrierBlocked'}]),o={REMOTE_PEER_HANGUP:'CollabRemotePeerHangup',REMOTE_PEER_REJECT:'CollabRemotePeerReject',CLOSED_BY_MCU:'CollabClosedByMcu',CLOSED_AS_STALE:'CollabClosedAsStale',CALL_INITIALIZATION_FAILED:'CollabCallInitializationFailed',SIP_CONNECTION_INITIALIZATION_FAILED:'CollabSipConnectionInitializationFailed',LOST_MCU_CONNECTION:'CollabLostMcuConnection',MCU_NO_AUDIO_STREAM:'CollabMcuNoAudioStream',MCU_INVALID_STREAM_CONFIGURATION:'CollabMcuInvalidStreamConfiguration',LOST_MCU_THRIFT_CONNECTION:'CollabLostMcuThriftConnection',LOST_SIP_ADAPTER_THRIFT_CONNECTION:'CollabLostSipAdapterThriftConnection',UNKNOWN:'CollabUnknown'},p={TOGGLE_SELF_VIEW:5,SUBMIT_STAR_RATING:6,SUBMIT_FEEDBACK:7,START_CALL:9,OPEN_SCREEN_IN_NEW:10},q={ONE_HOUR:'1hour',UNTIL_EIGHT_AM:'8am',ALWAYS:'always'},r=c('keyMirror')({VIDEO:null,AUDIO:null,SCREEN_SHARE:null}),s={CUSTOM:'custom',MULTIWAY:'multiway',P2P:'p2p'},t={NEW:'new',CHECKING:'checking',CONNECTED:'connected',completed:'completed',FAILED:'failed',DISCONNECTED:'disconnected',CLOSED:'closed'},u=c('keyMirror')({DOMINANT_SPEAKER:null,GRID:null,ONE_TO_ONE:null,STRIP:null}),v={PayloadType:h,ChildWindowMessageType:i,CallType:j,UploadLogLevel:k,StreamType:l,VideoQuality:m,CallEndReason:n,CollabCallEndSubreason:o,UIEventType:p,CallBlockingConstants:q,IncomingCallDialogTypes:r,SignalingProtocol:s,IceConnectionState:t,GroupVideoViewLayout:u,convertFromUploadLogLevel:function w(x){switch(x){case k.LL_DEBUG:return 'd';case k.LL_BASIC:return 'b';case k.LL_WARNING:return 'w';case k.LL_INFO:return 'i';case k.LL_VERBOSE:return 'v';case k.LL_NONE:default:return null;}},convertToUploadLogLevel:function w(x){switch(x){case 'd':return k.LL_DEBUG;case 'b':return k.LL_BASIC;case 'w':return k.LL_WARNING;case 'i':return k.LL_INFO;case 'v':return k.LL_VERBOSE;default:return k.LL_NONE;}},uploadLogLevelString:function w(x){switch(x){case k.LL_BASIC:return 'basic';case k.LL_DEBUG:return 'debug';case k.LL_WARNING:return 'warning';case k.LL_INFO:return 'info';case k.LL_VERBOSE:return 'verbose';default:return '';}},endCallReasonFromString:function w(x){return n.strNames.indexOf(x);},callEndReasonString:function w(x){if(x<0||x>n.strNames.length)return 'Unknown';return n.strNames[x];},fullCallEndReasonString:function w(x,y){return this.callEndReasonString(x)+'_'+(y?'remote':'local');}};f.exports=v;}),null);
__d("FBRTCVersionDetection",[],(function a(b,c,d,e,f,g){var h={isChrome:function i(){return !!navigator.webkitGetUserMedia;},isFirefox:function i(){return !!navigator.mozGetUserMedia;},webrtcVersion:function i(){if(this.isFirefox())return parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1],10);if(this.isChrome()){var j=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);if(j!==null){return parseInt(j[2],10);}else return 999;}return 0;}};f.exports=h;}),null);
__d('FBRTCUtils',['emptyFunction','randomInt','AsyncRequest','CurrentUser','FBID','FBRTCConfig','FBRTCConstants','FBRTCVersionDetection','RTCConfig','UserAgent'],(function a(b,c,d,e,f,g){var h=6000,i=window.URL||window.webkitURL,j=typeof document.createElement('video').setSinkId==='function',k={attachMediaStream:function l(m,n){if(window.webkitRTCPeerConnection){if(m.src)i.revokeObjectURL(m.src);if(n){m.src=i.createObjectURL(n);}else m.src='';}else{m.mozSrcObject=n;if(n)m.play();}},reattachMediaStream:function l(m,n){if(window.webkitRTCPeerConnection){m.src=n.src;}else{m.mozSrcObject=n.mozSrcObject;m.play();}},generateRandomInt:function l(){return c('randomInt')(0,4294967294)+1;},aboutEqual:function l(m,n){return m-n<.01&&n-m<.01;},getUploadLogLevel:function l(m){return Math.max(this.getLocalUploadLogLevel(),m);},getLocalUploadLogLevel:function l(){return c('CurrentUser').isEmployee()?c('FBRTCConstants').UploadLogLevel.LL_DEBUG:c('FBRTCConstants').UploadLogLevel.LL_NONE;},sendServerRequest:function l(m,n,o,p,q,r){n=n||c('emptyFunction');o=o||c('emptyFunction');p=p||false;q=q||h;r=r||{};var s=new (c('AsyncRequest'))().setURI(m).setData(r).setAllowCrossPageTransition(true).setHandler(n).setErrorHandler(o).setTimeoutHandler(q,function(){o();});if(p)s.setOption('asynchronous_DEPRECATED',false);s.send();},supportsMultipleStreamsPlanB:function l(){return (c('UserAgent').isBrowser('Chrome')||c('UserAgent').isBrowser('Opera'))&&c('FBRTCVersionDetection').webrtcVersion()>=34;},supportsSetSink:function l(){return j;},isPeerVCEndpoint:function l(m){var n=c('FBRTCConfig').isVCEndpointCall();return n!==undefined?n:m&&!c('FBID').isUser(m)&&c('RTCConfig').CollabVCEndpointsVideoCallGK;}};f.exports=k;}),null);
__d('FBRTCScreenSharingLogger',['Log','MarauderLogger','formatDate','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h='webrtc_screen_sharing',i=c('keyMirror')({P2P_VIDEO_CALL:null,DIRECT_SCREEN_SHARING:null}),j=c('keyMirror')({screen_sharing_action:null,screen_sharing_error:null}),k=c('keyMirror')({PEER_ID:null,SESSION_ID:null,CONTEXT_TYPE:null,CONTENT:null}),l=c('keyMirror')({SCREEN_SHARING_TOGGLED:null,SCREEN_SHARING_CANCELLED:null,SCREEN_SHARING_ENABLED:null,SCREEN_SHARING_DISABLED:null,SCREEN_SHARING_EXT_DIALOG:null,SCREEN_SHARING_EXT_LINK:null,SCREEN_SHARING_DIALOG_SUCCESS:null,SCREEN_SHARING_DIALOG_CANCEL:null}),m=null;n.getInstance=function(){if(!m)m=new n();return m;};n.prototype.logAction=function(o,p,q,r,s){var t={};t[j.screen_sharing_action]=q;t[k.PEER_ID]=o;t[k.SESSION_ID]=p;t[k.CONTEXT_TYPE]=this.$FBRTCScreenSharingLogger1(r);t[k.CONTENT]=s;this.$FBRTCScreenSharingLogger2(j.screen_sharing_action,t);this.logToConsole(o,p,q);};n.prototype.logError=function(o,p,q,r){var s={};s[k.PEER_ID]=o;s[k.SESSION_ID]=p;s[k.CONTEXT_TYPE]=this.$FBRTCScreenSharingLogger1(q);s[k.CONTENT]=r;this.$FBRTCScreenSharingLogger2(j.screen_sharing_error,s);this.logToConsole(o,p,r);};n.prototype.logToConsole=function(o,p,q){};n.prototype.$FBRTCScreenSharingLogger1=function(o){return o?i.DIRECT_SCREEN_SHARING:i.P2P_VIDEO_CALL;};n.prototype.$FBRTCScreenSharingLogger2=function(o,p){c('MarauderLogger').log(o,h,p);};function n(){}n.Action=l;f.exports=n;}),null);
__d('FBRTCScreenSharingUtils',['Promise','FBRTCScreenSharingLogger','FBRTCStruct','FBRTCVersionDetection','RTCConfig','FBRTCSupport'],(function a(b,c,d,e,f,g){'use strict';var h=new (c('FBRTCStruct'))(['UNKNOWN','INSTALLED']),i=h.UNKNOWN,j={RECIPIENT:'SC_CONTENT_SCRIPT',isScreenSharingSupported:function k(){return c('RTCConfig').ScreenSharingGK;},isSupportedBrowser:function k(){return c('FBRTCVersionDetection').isChrome()&&c('FBRTCVersionDetection').webrtcVersion()>=34;},canUserReceiveScreenSharing:function k(){return c('RTCConfig').ReceiveScreenGK&&c('FBRTCSupport').isOSSupported()&&j.isSupportedBrowser();},isExtensionInstalled:function k(){return i===h.INSTALLED;},getExtensionStatus:function k(){return i;},checkExtensionInstalled:function k(){if(this.isExtensionInstalled())return c('Promise').resolve();var l=void 0,m=new (c('Promise'))(function(n){l=function o(p){var q=p.origin,r=p.data;if(q!=window.location.origin||!r.type)return;if(r.type==='SC_EXT_INSTALLED'){window.removeEventListener('message',l);i=h.INSTALLED;n();}};window.addEventListener('message',l);});return c('Promise').race([m,this._pokeExtension()])['catch'](function(n){window.removeEventListener('message',l);return c('Promise').reject(n);});},_pokeExtension:function k(){var l=arguments.length<=0||arguments[0]===undefined?13:arguments[0];return new (c('Promise'))(function(m,n){var o=setInterval(function(){setTimeout(function(){if(i===h.UNKNOWN)window.postMessage({recipient:j.RECIPIENT,type:'SC_IS_EXT_INSTALLED',text:'is extension installed'},'*');});if(l>0){l--;}else{clearInterval(o);n('extension unavailable');}},200);});},logFailedAttempt:function k(l,m){c('FBRTCScreenSharingLogger').getInstance().logAction(l,m,c('FBRTCScreenSharingLogger').Action.SCREEN_SHARING_TOGGLED,this._isDirect,'feature not available');}};f.exports=j;}),null);
__d('RTCSignalingExperiments',['FBRTCUtils','FBRTCScreenSharingUtils','Set','UserAgent'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.$RTCSignalingExperiments2=new (c('Set'))();this.$RTCSignalingExperiments1=new (c('Set'))(h.getLocal());if(i)this.$RTCSignalingExperiments2=new (c('Set'))(i);}h.prototype.getLocal=function(){return Array.from(this.$RTCSignalingExperiments1);};h.prototype.setRemote=function(i){if(!i)return this;return new h(i);};h.prototype.getRemote=function(){return Array.from(this.$RTCSignalingExperiments2);};h.prototype.support=function(i){return this.localSupport(i)&&this.remoteSupport(i);};h.prototype.localSupport=function(i){return this.$RTCSignalingExperiments1.has(i);};h.prototype.remoteSupport=function(i){return this.$RTCSignalingExperiments2.has(i);};h.getLocal=function(){var i=[];if(c('UserAgent').isBrowser('Chrome')||c('UserAgent').isBrowser('Opera'))i.push('sdp_update');if(c('FBRTCUtils').supportsMultipleStreamsPlanB())i.push('multiple_streams_plan_b');if(c('FBRTCScreenSharingUtils').canUserReceiveScreenSharing())i.push('screen_sharing');return i;};f.exports=h;}),null);
__d('FBRTCCallControlActions',['FBRTCDispatcher','keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({ACCEPT_ESCALATION:null,HANG_UP:null,PARENT_WINDOW_START_CALL:null,TOGGLE_FULL_SCREEN:null,TOGGLE_MUTE_AUDIO:null,TOGGLE_MUTE_VIDEO:null,TOGGLE_SCREEN_SHARING:null,TOGGLE_SELF_VIEW:null,SHOW_SETTINGS:null,START_CALL:null,DECLINE_ESCALATION:null,RECEIVED_SIGNALING_MESSAGE:null,RESET_CALL:null,OPEN_SCREEN_IN_NEW:null,CLOSE_STANDALONE_SCREEN:null,REDIAL_CALL:null}),i={Types:h,hangUp:function j(){c('FBRTCDispatcher').dispatch({type:h.HANG_UP});},toggleMuteAudio:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_MUTE_AUDIO});},toggleMuteVideo:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_MUTE_VIDEO});},toggleFullScreen:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_FULL_SCREEN});},toggleSelfView:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_SELF_VIEW});},showSettings:function j(){c('FBRTCDispatcher').dispatch({type:h.SHOW_SETTINGS});},toggleScreenSharing:function j(){c('FBRTCDispatcher').dispatch({type:h.TOGGLE_SCREEN_SHARING});},startCall:function j(){c('FBRTCDispatcher').dispatch({type:h.START_CALL});},openScreenInNewWindow:function j(){c('FBRTCDispatcher').dispatch({type:h.OPEN_SCREEN_IN_NEW});},receivedSignalingMessage:function j(k){c('FBRTCDispatcher').dispatch({type:h.RECEIVED_SIGNALING_MESSAGE,message_type:k.msgType,message:k});},acceptEscalation:function j(){c('FBRTCDispatcher').dispatch({type:h.ACCEPT_ESCALATION});},declineEscalation:function j(){c('FBRTCDispatcher').dispatch({type:h.DECLINE_ESCALATION});},resetCall:function j(k){c('FBRTCDispatcher').dispatch({type:h.RESET_CALL,trigger:k});},redialCall:function j(){c('FBRTCDispatcher').dispatch({type:h.REDIAL_CALL});},parentWindowStartCall:function j(){c('FBRTCDispatcher').dispatch({type:h.PARENT_WINDOW_START_CALL});}};f.exports=i;}),null);
__d('FBRTCLogger',['Log','LogHistory','MarauderLogger','formatDate','pageID'],(function a(b,c,d,e,f,g){var h='webrtc',i='sent_message',j='received_message',k='send_succeeded',l='send_failed',m='info',n='call_action',o='client_event',p='client_error',q='type',r='msg_id',s='ack_msg_id',t='call_id',u='from',v='to',w='content',x='tag',y='peer_id',z='error_code',aa='trigger',ba='endcallstats',ca=null;da.getInstance=function(){'use strict';if(!ca)ca=new da();return ca;};function da(){'use strict';this.$FBRTCLogger1=c('LogHistory').getInstance(h);}da.prototype.logToConsole=function(ea){'use strict';var fa='Console';this.$FBRTCLogger2(null,null,fa,ea);this.$FBRTCLogger1.log(fa,ea);};da.prototype.logReceivedMessage=function(ea,fa,ga){'use strict';var ha={};ha[u]=ea;ha[t]=fa;ha[q]=ga.type;ha[r]=ga.msg_id;if(ga.sdp)ha[w]=ga.sdp;if(ga.ack_id)ha[s]=ga.ack_id;this.$FBRTCLogger3(j,ha);this.$FBRTCLogger2(ea,fa,'Received',ga.type+', '+ga.msg_id);};da.prototype.logSentMessage=function(ea,fa,ga){'use strict';var ha={};ha[v]=ea;ha[t]=fa;ha[q]=ga.type;ha[r]=ga.msg_id;if(ga.sdp)ha[w]=ga.sdp;if(ga.ack_id)ha[s]=ga.ack_id;this.$FBRTCLogger3(i,ha);this.$FBRTCLogger2(ea,fa,'Sent',ga.type+', '+ga.msg_id);};da.prototype.logSentMessageSuccess=function(ea,fa,ga,ha){'use strict';var ia={};ia[y]=ea;ia[t]=fa;ia[q]=ga;ia[r]=ha;this.$FBRTCLogger3(k,ia);};da.prototype.logSentMessageFailure=function(ea,fa,ga,ha,ia){'use strict';var ja={};ja[y]=ea;ja[t]=fa;ja[q]=ga;ja[r]=ha;ja[z]=ia;this.$FBRTCLogger3(l,ja);this.$FBRTCLogger2(ea,fa,'Send Failed',ga+', '+ia);};da.prototype.logCallAction=function(ea,fa,ga,ha,ia){'use strict';var ja={};ja[y]=ea;ja[t]=fa;ja[n]=ga;ja[w]=ha;if(ia)ja[aa]=ia;this.$FBRTCLogger3(n,ja);this.$FBRTCLogger2(ea,fa,'CallAction',ga+', '+ha);};da.prototype.logEvent=function(ea,fa,event){'use strict';var ga={};ga[y]=ea;ga[t]=fa;ga[w]=event;this.$FBRTCLogger3(o,ga);this.$FBRTCLogger2(ea,fa,'Event',event);};da.prototype.logInfo=function(ea,fa,ga){'use strict';var ha={};ha[y]=ea;ha[t]=fa;ha[w]=ga;this.$FBRTCLogger3(m,ha);this.$FBRTCLogger2(ea,fa,'Info',ga);};da.prototype.logError=function(ea,fa,ga){'use strict';var ha={};ha[y]=ea;ha[t]=fa;ha[w]=ga;this.$FBRTCLogger3(p,ha);this.$FBRTCLogger2(ea,fa,'Error',ga);};da.prototype.logErrorWithoutID=function(ea){'use strict';this.logError(null,null,ea);};da.prototype.logEndCallSummary=function(ea){'use strict';if(!ea)return;var fa={};fa[y]=ea.peerID;fa[t]=ea.callID;fa[x]=ba;fa[w]=ea.toString();var ga=ea.getExtraInfo();for(var ha in ga)if(Object.prototype.hasOwnProperty.call(ga,ha))fa[ha]=ga[ha];this.$FBRTCLogger3(m,fa);this.$FBRTCLogger2(ea.peerID,ea.callID,'Call Summary',fa);};da.prototype.$FBRTCLogger3=function(ea,fa){'use strict';fa.page_id=c('pageID');this.$FBRTCLogger1.log(ea,fa);c('MarauderLogger').log(ea,h,fa);};da.prototype.$FBRTCLogger2=function(ea,fa,ga,ha){'use strict';};da.CallAction={START_CALL:'start_call',RECEIVED_CALL:'received_call',ANSWER_CALL:'answer_call',END_CALL:'end_call',DENIED_PERMISSION:'denied_permission',SET_MUTE:'set_mute',SET_VIDEO_ON:'set_video_on',SET_SELF_VIEW_ON:'set_self_view_on',SET_FULLSCREEN_ON:'set_fullscreen_on',START_SKYPE:'start_skype',TRY_NEW:'try_new',OPEN_POPUP:'open_popup',POPUP_OPENED:'popup_opened',AUTO_DISABLE_VIDEO:'auto_disable_video',FAILED_GETTING_URI:'failed_getting_uri',OLD_URI:'old_uri',USER_SETTINGS_CHANGED:'user_settings_changed'};da.Trigger={ADMIN_MESSAGE:'admin_message',CHAT_TAB_ICON:'chat_tab_icon',CHAT_TAB_ICON_TOUR:'chat_tab_icon_tour',CHAT_TAB_VOICE_ICON:'chat_tab_voice_icon',SKYPE_DEPRECATION_DIALOG:'skype_deprecation_dialog',REDIAL_BUTTON:'redial_button',RETURN_CALL:'return_call',WEB_MESSENGER:'web_messenger',POPUP_CALL_START_BUTTON:'popup_start_call_button',TIMELINE_PROFILE:'timeline_profile',UNKNOWN:'unknown',RESET_CALL:'install_screen_sharing_ext_dialog',MULTIWAY_CHAT_TAB_SHEET_JOIN_CALL_BUTTON:'multiway_chat_tab_sheet_join_call_button',MULTIWAY_POPUP_START_CALL_BUTTON:'multiway_popup_start_call_button',MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:'multiway_thread_header_audio_button',MULTIWAY_THREAD_HEADER_VIDEO_BUTTON:'multiway_thread_header_video_button',MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:'multiway_thread_header_join_audio_call_audio_button',MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:'multiway_thread_header_join_audio_call_video_button',MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:'multiway_thread_header_join_video_call_audio_button',MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON:'multiway_thread_header_join_video_call_video_button',MULTIWAY_THREAD_LIST_JOIN_CALL_BUTTON:'multiway_thread_list_join_call_button'};da.Key={DEVICE_INFO:'device_info',RATING:'rating5',RATING_SHOWN:'rating_shown',SURVEY_CHOICE:'survey_choice',SURVEY_DETAILS:'survey_details',SURVEY_SHOWN:'survey_shown',INITIATED_BY_PAGE_ID:'initiated_by_page_id',PEER_IS_MOBILE:'peer_is_mobile'};f.exports=da;}),null);
__d('FBRTCLocalMessageQueue',['CacheStorage','FBRTCLogger','Map','RTCConfig'],(function a(b,c,d,e,f,g){var h='localstorage',i='RTC_',j='offer',k='offer_msg',l='data_',m=30*1000,n=15*1000,o=500,p=new (c('Map'))();function q(){'use strict';this.$FBRTCLocalMessageQueue1=c('FBRTCLogger').getInstance();}q.prototype.enqueueOffer=function(r,s){'use strict';var t=this.$FBRTCLocalMessageQueue2(r,k);this.$FBRTCLocalMessageQueue3(t,j,s);};q.prototype.getOffer=function(r){'use strict';var s=this.$FBRTCLocalMessageQueue2(r,k);return this.$FBRTCLocalMessageQueue4(s,j);};q.prototype.removeOffer=function(r){'use strict';var s=this.$FBRTCLocalMessageQueue2(r,k);s.remove(j);};q.prototype.enqueueMessage=function(r,s,t,u){'use strict';var v=l+t.toString(),w=p.get(r)||new (c('Map'))();w.set(v,u);p.set(r,w);this.$FBRTCLocalMessageQueue1.logToConsole('Queued '+v);};q.prototype.drainQueue=function(r,s){'use strict';var t=p.get(r)||new (c('Map'))(),u,v;for(var w=t,x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z,u=aa[0],v=aa[1];void u;s(v);}p.set(r,new (c('Map'))());};q.prototype.enableDequeuing=function(r,s,t,u){'use strict';if(u===undefined)u=n;this.$FBRTCLocalMessageQueue5(r,s,t,u);};q.prototype.$FBRTCLocalMessageQueue5=function(r,s,t,u){'use strict';var v=this.$FBRTCLocalMessageQueue2(r,s),w=v.keys(),x=w.length;for(var y=0;y<x;y++){var z=this.$FBRTCLocalMessageQueue6(v,w[y]);if(z&&t)t(z);}this.$FBRTCLocalMessageQueue1.logToConsole('Dequeued '+x+' ('+r+') with '+u+' left)');if(u>0){u-=o;setTimeout(function(){this.$FBRTCLocalMessageQueue5(r,s,t,u);}.bind(this),o);}};q.prototype.$FBRTCLocalMessageQueue3=function(r,s,t){'use strict';var u={__t:Date.now(),__d:t};r.set(s,u);};q.prototype.$FBRTCLocalMessageQueue4=function(r,s){'use strict';var t=r.get(s);if(t&&this.$FBRTCLocalMessageQueue7(t)){return t.__d;}else if(t)r.remove(s);return null;};q.prototype.$FBRTCLocalMessageQueue6=function(r,s){'use strict';var t=this.$FBRTCLocalMessageQueue4(r,s);if(t!==null){r.remove(s);return t;}return null;};q.prototype.$FBRTCLocalMessageQueue7=function(r){'use strict';return Date.now()-r.__t<m;};q.prototype.$FBRTCLocalMessageQueue2=function(r,s){'use strict';return new (c('CacheStorage'))(h,''+i+r+'_'+s+'_');};f.exports=q;}),null);
__d('FBRTCMessageListener',['invariant','Arbiter','ChannelConstants','FBRTCConstants','FBRTCCallControlActions','FBRTCLocalMessageQueue','FBRTCSupport','RTCConfig','guid','mixInEventEmitter'],(function a(b,c,d,e,f,g,h){'use strict';var i=c('FBRTCConstants').ChildWindowMessageType,j=45*1000,k=[],l=null,m=null,n=null,o=null,p=null,q=false,r=null,s=void 0,t={init:function u(v,w){if(q)return;q=true;c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc'),function(y,z){this._onMessage(z.obj);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc_offer'),function(y,z){this._onMessage(z.obj);}.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('webrtc_offerack'),function(y,z){this._onMessage(z.obj);}.bind(this));if(c('RTCConfig').RtcConferencingGK)c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('rtc_multi_json'),function(y,z){this._onMultiwayMessage(z.obj);}.bind(this));this._localMessageQueue=new (c('FBRTCLocalMessageQueue'))();if(c('RTCConfig').PassMessagesBetweenWindowsGK){if(c('FBRTCSupport').isWebrtcSupported()&&window.addEventListener){var x=v?this._handleWindowMessageToChild.bind(this):this._handleWindowMessageToParent.bind(this);window.addEventListener('message',x,false);}if(v)this._connectToParentWindow(w);}},setParentWindowNonce:function u(v){o=v;},generateNewNonce:function u(){p=c('guid')();return p;},setMultiwayMessageHandler:function u(v,w){!r||h(0);r=w?v.bind(w):v;},_onMultiwayMessage:function u(v){this.emit('multiwayMessageReceived',v);if(r)r(v);},setMessageHandler:function u(v,w){!l||h(0);l=w?v.bind(w):v;while(k.length)l(k.shift());},removeMessageHandler:function u(){l=null;},setParentWindowStartCallHandler:function u(v){s=v;return function(){return s=null;};},_onMessage:function u(v){this.emit('messageReceived',v);if(l){l(v);}else k.push(v);this._passMessageToChildWindow(v);},_connectToParentWindow:function u(v){if(window.opener&&window.opener.postMessage){var w={type:i.CHILD_WINDOW_READY,nonce:o,childNonce:this.generateNewNonce(),peerID:v};window.opener.postMessage(w,window.location.origin);}},_verifyWindowMessage:function u(event){return event.origin===window.location.origin&&event.data&&p&&event.data.nonce===p;},_handleWindowMessageToParent:function u(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_READY){this.setParentWindowNonce(event.data.childNonce);this._setChildWindow(event.source);this._replayQueuedMessagesToChild(event.data.peerID,m);}},_handleWindowMessageToChild:function u(event){if(!this._verifyWindowMessage(event))return;if(event.data.type===i.CHILD_WINDOW_MESSAGE)this._onMessage(event.data.message);if(event.data.type===i.CHILD_WINDOW_START_CALL)if(s){s();}else c('FBRTCCallControlActions').parentWindowStartCall();},_replayQueuedMessagesToChild:function u(v,w){this._localMessageQueue.drainQueue(v,function(x){var y={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:x};w.postMessage(y,window.location.origin);});},_setChildWindow:function u(v){m=v;clearTimeout(n);n=setTimeout(function(){m=null;},j);this._startCallInChildWindow();this.generateNewNonce();},_passMessageToChildWindow:function u(v){if(m){var w={type:i.CHILD_WINDOW_MESSAGE,nonce:o,message:v};m.postMessage(w,window.location.origin);}},_startCallInChildWindow:function u(){if(m){var v={type:i.CHILD_WINDOW_START_CALL,nonce:o};m.postMessage(v,window.location.origin);}}};c('mixInEventEmitter')(t,{messageReceived:true,multiwayMessageReceived:true});f.exports=t;}),null);
__d('FBRTCCallUIWrapper',['regeneratorRuntime','Bootloader','FBRTCCallActions','FBRTCConfig','FBRTCMessageListener','UserAgent'],(function a(b,c,d,e,f,g){var h=null,i={openGroupCallUI:function j(k,l,m,n,o,p){return c('regeneratorRuntime').async(function q(r){while(1)switch(r.prev=r.next){case 0:h=this._openWindow('Group Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(s){s.openGroupCallUI(k,l,m,n,o,h,p);},'FBRTCCallUIWrapper');case 2:case 'end':return r.stop();}},null,this);},openGroupCallURI:function j(k,l,m,n,o,p){return c('regeneratorRuntime').async(function q(r){while(1)switch(r.prev=r.next){case 0:h=this._openWindow('Group Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(s){s.openGroupCallURI({conferenceName:k,callID:l,hasVideo:m,serverInfoData:n,trigger:o,callSummary:p,callWindow:h});},'FBRTCCallUIWrapper');case 2:case 'end':return r.stop();}},null,this);},openAsCaller:function j(k,l,m,n){if(!h&&window.rtcCallChildWindow){h=window.rtcCallChildWindow;window.rtcCallChildWindow=null;}if(this._shouldFocusCallWindow(k)){h.focus();return;}if(this._shouldCloseCallWindow())h.close();if(c('FBRTCConfig').useCurrentWindow()){c('FBRTCMessageListener').removeMessageHandler();c('FBRTCCallActions').startCall(k,l,true,n);c('Bootloader').loadModules(["FBRTCCallUI"],function(o){o.openAsCaller(k,l,m,n);},'FBRTCCallUIWrapper');return;}h=this._openWindow('Video Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(o){o.openAsCaller(k,l,m,n,h);},'FBRTCCallUIWrapper');},openAsCallee:function j(k,l,m,n,o){if(c('FBRTCConfig').useCurrentWindow()){c('FBRTCMessageListener').removeMessageHandler();c('FBRTCCallActions').startCall(k,l,false,o);c('Bootloader').loadModules(["FBRTCCallUI"],function(p){p.openAsCallee(k,l,m,n,o,null);},'FBRTCCallUIWrapper');return;}h=this._openWindow('Video Call');c('Bootloader').loadModules(["FBRTCCallUI"],function(p){p.openAsCallee(k,l,m,n,o,h);},'FBRTCCallUIWrapper');},_shouldFocusCallWindow:function j(k){return h&&!h.closed&&h.rtcCallInProgessWith===k;},_shouldCloseCallWindow:function j(){return h&&!h.closed&&!h.rtcCallInProgessWith;},_openWindow:function j(k){var l=this._windowPosition(),m=['menubar=no','location=no','scrollbars=no','status=no','personalbar=no',l.height,l.width,l.top,l.left].join(',');if(this._isSparkBrowser())m='';return window.open('',k,m);},_windowPosition:function j(){var k=960,l=540,m,n,o,p;if(screen&&screen.width>1280){k=1280;l=720;}if(window.innerWidth!==undefined){n=window.innerWidth;m=window.innerHeight;}else{n=screen.width;m=screen.height;}if(window.screenLeft!==undefined){o=window.screenLeft;p=window.screenTop;}else{o=window.screenX;p=window.screenY;}var q=Math.floor(n/2-k/2+o),r=Math.floor(m/2-l/2+p);return {height:'height='+l.toString(),width:'width='+k.toString(),top:'top='+r.toString(),left:'left='+q.toString()};},_isSparkBrowser:function j(){return c('UserAgent').isBrowser('Chrome < 34')&&c('UserAgent').isBrowser('Chrome > 33');}};f.exports=i;}),null);
__d('FBRTCCore',['invariant','Bootloader','FBRTCAvailability','FBRTCCallUIWrapper','FBRTCSupport','randomInt'],(function a(b,c,d,e,f,g,h){var i=false,j={startOutgoingCall:function k(l,m,n){var o=arguments.length<=3||arguments[3]===undefined?false:arguments[3];!/\D/.test(l)||h(0);if(i)return;i=true;setTimeout(function(){i=false;},1000);if(o&&!c('FBRTCSupport').isCollabSupported()){c('Bootloader').loadModules(["FBRTCUnsupportedBrowserMessage","CollabMessengerLogger"],function(q,r){q.showForUnsupportedCollabCall();r.logBrowserNotSupported({peerID:l});},'FBRTCCore');}else if(!c('FBRTCSupport').isWebrtcSupported()){c('Bootloader').loadModules(["FBRTCUnsupportedBrowserMessage"],function(q){q.showForOutgoingCall();},'FBRTCCore');}else{var p=this._generateCallID();c('FBRTCCallUIWrapper').openAsCaller(l,p,m,n);}},startGroupCall:function k(l){var m=l.conferenceName,n=l.hasVideo,o=l.serverInfoData,p=l.trigger,q=l.usersToRing,r=q===undefined?[]:q;if(i)return;i=true;setTimeout(function(){i=false;},1000);if(!c('FBRTCSupport').isGroupCallWebtrcSupported()){c('Bootloader').loadModules(["MessengerRTCGroupCallUnsupportedBrowserDialogController"],function(s){s.render({hasVideo:n});},'FBRTCCore');return;}c('FBRTCCallUIWrapper').openGroupCallUI(m,this._generateCallID(),r,n,p,o);},isAvailableForWebrtcCalling:function k(l){return c('FBRTCAvailability').isCallable(l);},shouldEnableVideoCalling:function k(){return c('FBRTCSupport').isOSSupported();},startScreenSharingSession:function k(l,m){!/\D/.test(l)||h(0);if(i)return;i=true;setTimeout(function(){i=false;},1000);if(!c('FBRTCSupport').isWirelessScreenSharingSupported()){c('Bootloader').loadModules(["FBRTCUnsupportedBrowserMessage","CollabMessengerLogger"],function(n,o){n.showForUnsupportedCollabScreenSharing();o.logBrowserNotSupported({peerID:l});},'FBRTCCore');return;}c('Bootloader').loadModules(["RTCWirelessScreenSharingWindowHandler"],function(n){n.open(l,this._generateCallID(),m);}.bind(this),'FBRTCCore');},_generateCallID:function k(){return c('randomInt')(0,4294967295);}};f.exports=j;}),null);
__d('FBRTCCallabilityActions',['keyMirror'],(function a(b,c,d,e,f,g){'use strict';var h=c('keyMirror')({CALLABILITY_FETCHED:null,CALLABILITY_FETCH_ERROR:null});function i(j){this.$FBRTCCallabilityActions1=j;}i.prototype.callabilityFetched=function(j,k){this.$FBRTCCallabilityActions1.dispatch({type:h.CALLABILITY_FETCHED,userID:j,callability:k});};i.prototype.callabilityFetchError=function(j){this.$FBRTCCallabilityActions1.dispatch({type:h.CALLABILITY_FETCH_ERROR,userID:j});};i.Types=h;f.exports=i;}),null);
__d("XRTCCallabilityController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/rtc\/callability\/",{user_id:{type:"FBID",required:true}});}),null);
__d('FBRTCCallabilityDataManager',['AsyncRequest','FBRTCCallabilityActions','TimeSlice','XRTCCallabilityController'],(function a(b,c,d,e,f,g){'use strict';function h(i){this.$FBRTCCallabilityDataManager1=new (c('FBRTCCallabilityActions'))(i);}h.prototype.fetchCallability=function(i){c('TimeSlice').guard(function(){var j=c('XRTCCallabilityController').getURIBuilder().setFBID('user_id',i).getURI(),k=this.$FBRTCCallabilityDataManager2.bind(this,i),l=this.$FBRTCCallabilityDataManager3.bind(this,i);new (c('AsyncRequest'))().setURI(j).setHandler(k).setErrorHandler(l).setAllowCrossPageTransition(true).send();}.bind(this),'Chat Tab RTC Callability Check',{isContinuation:false})();};h.prototype.$FBRTCCallabilityDataManager2=function(i,j){this.$FBRTCCallabilityDataManager1.callabilityFetched(i,j.payload);};h.prototype.$FBRTCCallabilityDataManager3=function(i,j){this.$FBRTCCallabilityDataManager1.callabilityFetchError(i);};f.exports=h;}),null);
__d('TreeMap',['Map','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(v,w,x){this.key=v;this.value=w;this.time=x;}function i(v){this.$TreeMap1=function(w,x){var y=v(w,x);return y!==0?y:w.time-x.time;};this.$TreeMap2=new (c('Map'))();this.$TreeMap3=null;this.$TreeMap4=0;this.size=this.$TreeMap2.size;}i.prototype.clear=function(){this.$TreeMap2=new (c('Map'))();this.$TreeMap3=null;this.size=this.$TreeMap2.size;};i.prototype.has=function(v){return this.$TreeMap2.has(v);};i.prototype.set=function(v,w){if(this.has(v))this['delete'](v);var x=new h(v,w,this.$TreeMap4++);this.$TreeMap2.set(v,x);this.$TreeMap3=p(this.$TreeMap3,x,this.$TreeMap1);this.size=this.$TreeMap2.size;return this;};i.prototype.get=function(v){return this.has(v)?this.$TreeMap2.get(v).value:undefined;};i.prototype['delete']=function(v){if(!this.has(v))return false;var w=this.$TreeMap2.get(v);this.$TreeMap3=q(this.$TreeMap3,w,this.$TreeMap1);this.$TreeMap2['delete'](v);this.size=this.$TreeMap2.size;return true;};i.prototype.keys=function(){var v=[];u(this.$TreeMap3,v,function(w){return w.key;});return v;};i.prototype.values=function(){var v=[];u(this.$TreeMap3,v,function(w){return w.value;});return v;};i.prototype.entries=function(){var v=[];u(this.$TreeMap3,v,function(w){return {key:w.key,value:w.value};});return v;};i.prototype.range=function(v,w){var x=[],y=null;if(v)y=new h(v.key,v.value,-1);var z=null;if(w)z=new h(w.key,w.value,this.$TreeMap4);u(this.$TreeMap3,x,function(aa){return {key:aa.key,value:aa.value};},this.$TreeMap1,y,z);return x;};i.prototype.min=function(){if(!this.$TreeMap3)return undefined;var v=r(c('nullthrows')(this.$TreeMap3)),w=v.key,x=v.value;return {key:w,value:x};};i.prototype.max=function(){if(!this.$TreeMap3)return undefined;var v=s(c('nullthrows')(this.$TreeMap3)),w=v.key,x=v.value;return {key:w,value:x};};i.prototype.__testRoot=function(){};function j(v){if(!v)return v;o(v);if(v.balanceFactor<-1){if(v.right&&v.right.balanceFactor<=0){return k(v);}else return l(v);}else if(v.balanceFactor>1){if(v.left&&v.left.balanceFactor>=0){return m(v);}else return n(v);}else return v;}function k(v){var w=v,x=c('nullthrows')(w.right),y=x.left;w.right=y;o(w);c('nullthrows')(x).left=w;o(x);return x;}function l(v){var w=v,x=c('nullthrows')(w.right),y=c('nullthrows')(x.left),z=y.left,aa=y.right;w.right=z;o(w);x.left=aa;o(x);y=c('nullthrows')(y);y.left=w;y.right=x;o(y);return y;}function m(v){var w=v,x=c('nullthrows')(w.left),y=x.right;w.left=y;o(w);x.right=w;o(x);return x;}function n(v){var w=v,x=c('nullthrows')(w.left),y=c('nullthrows')(x.right),z=y.left,aa=y.right;x.right=z;o(x);w.left=aa;o(w);y.left=x;y.right=w;o(y);return y;}function o(v){var w=v.left?v.left.height:-1,x=v.right?v.right.height:-1;v.height=Math.max(w,x)+1;v.balanceFactor=w-x;}function p(v,w,x){if(v==null)return j(w);var y=x(w,v);if(y<0){v.left=p(v.left,w,x);return j(v);}else{v.right=p(v.right,w,x);return j(v);}}function q(v,w,x){if(v==null)return null;if(v===w)if(v.left&&v.right){var y=s(v.left);v.left=t(v.left);y.left=v.left;y.right=v.right;return j(y);}else if(v.left){return j(v.left);}else if(v.right){return j(v.right);}else return null;var z=x(w,v);if(z<0){v.left=q(v.left,w,x);return j(v);}else{v.right=q(v.right,w,x);return j(v);}}function r(v){while(v.left)v=v.left;return v;}function s(v){while(v.right)v=v.right;return v;}function t(v){if(!v)return null;if(v.right==null)return j(v.left||null);v.right=t(v.right);return j(v);}function u(v,w,x,y,z,aa){if(v==null)return;var ba=!y||!z||y(v,z)>=0,ca=!y||!aa||y(v,aa)<=0;if(ba)u(v.left,w,x,y,z,aa);if(ba&&ca)w.push(x(v));if(ca)u(v.right,w,x,y,z,aa);}f.exports=i;}),null);
__d('Cache',['DateConsts','Map','TimeSlice','TreeMap'],(function a(b,c,d,e,f,g){'use strict';function h(){this.$Cache1=new (c('Map'))();}h.prototype.has=function(i){return this.$Cache1.has(i);};h.prototype.get=function(i,j){var k=this.__getRaw(i);if(!k)return j;return k.$Cache2;};h.prototype.getAll=function(i,j){var k=new (c('Map'))();i.forEach(function(l){return k.set(l,this.get(l,j));}.bind(this));return k;};h.prototype['delete']=function(i){var j=this.__getRaw(i);if(j&&j.$Cache3)clearTimeout(j.$Cache3);return this.$Cache1['delete'](i);};h.prototype.clear=function(){this.$Cache1.forEach(function(i){if(i&&i.$Cache3)clearTimeout(i.$Cache3);});this.$Cache1.clear();};h.prototype.set=function(i,j,k,l){if(!this.shouldUpdate(i,k))return false;var m=this.__getRaw(i);if(!m)m=this.__getNewRawObject();delete m.$Cache2;delete m.$Cache4;if(m.$Cache3)clearTimeout(m.$Cache3);delete m.$Cache3;m.$Cache2=j;if(k!=null)m.$Cache4=k;if(l!=null&&l>=0)m.$Cache3=setTimeout(c('TimeSlice').guard(this['delete'].bind(this,i),'Cache expiration timeout'),l*c('DateConsts').MS_PER_SEC*c('DateConsts').SEC_PER_MIN);this.__setRaw(i,m);return true;};h.prototype.shouldUpdate=function(i,j){var k=this.__getRaw(i);return k==null||k.$Cache4==null||j==null||j>k.$Cache4;};h.prototype.size=function(){return this.$Cache1.size;};h.prototype.__getRaw=function(i){return this.$Cache1.get(i);};h.prototype.__setRaw=function(i,j){this.$Cache1.set(i,j);};h.prototype.__getNewRawObject=function(){return {$Cache2:null,$Cache3:null,$Cache4:null,$Cache5:null,$Cache6:null};};h.prototype.__keys=function(){return this.$Cache1.keys();};f.exports=h;}),null);
__d('RTCCallabilityStore',['fbt','Cache','FBRTCAvailability','FluxStore','FBRTCCallabilityActions','FBRTCCallabilityDataManager'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k=.5,l=5;i=babelHelpers.inherits(m,c('FluxStore'));j=i&&i.prototype;function m(n){j.constructor.call(this,n);this.$RTCCallabilityStore2=new (c('FBRTCCallabilityDataManager'))(n);this.$RTCCallabilityStore1=new (c('Cache'))();}m.prototype.__onDispatch=function(n){var o=n.type;switch(o){case c('FBRTCCallabilityActions').Types.CALLABILITY_FETCHED:var p=n.userID,q=n.callability;this.$RTCCallabilityStore1.set(p,q.is_callable,null,q.is_callable?l:k);this.__emitChange();break;case c('FBRTCCallabilityActions').Types.CALLABILITY_FETCH_ERROR:this.$RTCCallabilityStore1.set(n.userID,false,null,k);this.__emitChange();break;}};m.prototype.isCallable=function(n){if(c('FBRTCAvailability').isCallable(n))return true;if(!this.$RTCCallabilityStore1.has(n)){this.$RTCCallabilityStore2.fetchCallability(n);this.$RTCCallabilityStore1.set(n,false,null,k);}return !!this.$RTCCallabilityStore1.get(n);};m.prototype.callButtonTooltip=function(n,o){if(this.isCallable(n))return h._("Start a video chat with {shortname}",[h.param('shortname',o)]);return h._("{shortname} is currently unavailable for video calling",[h.param('shortname',o)]);};m.prototype.voiceCallButtonTooltip=function(n,o){if(this.isCallable(n))return h._("Start a voice call with {shortname}",[h.param('shortname',o)]);return h._("{shortname} is currently unavailable for voice calling",[h.param('shortname',o)]);};f.exports=m;}),null);
__d('FBRTCCallabilityStore',['FBRTCDispatcher','RTCCallabilityStore'],(function a(b,c,d,e,f,g){'use strict';f.exports=new (c('RTCCallabilityStore'))(c('FBRTCDispatcher'));}),null);
__d('MercuryAudienceRestrictedTypeaheadDataSource',['CurrentUser','DataSource','MercuryParticipantTypes','MercuryTypeaheadConstants','OrderedFriendsList','ShortProfiles'],(function a(b,c,d,e,f,g){var h,i;h=babelHelpers.inherits(j,c('DataSource'));i=h&&h.prototype;function j(k){'use strict';k=k||{};k.kanaNormalization=true;k.maxResults=c('MercuryTypeaheadConstants').COMPOSER_CHATTAB_MAX;k.minQueryLength=2;i.constructor.call(this,k);this.$MercuryAudienceRestrictedTypeaheadDataSource1=false;this.$MercuryAudienceRestrictedTypeaheadDataSource2=false;this.$MercuryAudienceRestrictedTypeaheadDataSource3={};this.$MercuryAudienceRestrictedTypeaheadDataSource4=true;this.queryCache={};this.localCache={};this.queryIDs={};}j.prototype.dirty=function(){'use strict';return this;};j.prototype.buildData=function(k){'use strict';return i.buildData.call(this,k);};j.prototype.query=function(k,l,m,n){'use strict';var o=l||k.length===1;return i.query.call(this,k,o,m,n);};j.prototype.getQueryData=function(k,l){'use strict';return babelHelpers['extends']({},i.getQueryData.call(this,k,l));};j.prototype.setEntry=function(k,l){'use strict';this.$MercuryAudienceRestrictedTypeaheadDataSource3[k]=l;};j.prototype.getEntry=function(k){'use strict';return this.$MercuryAudienceRestrictedTypeaheadDataSource3[k]||null;};j.prototype.getCachedShortProfileIDs=function(){'use strict';var k=c('ShortProfiles').getCachedProfileIDs(),l=k.filter(function(m){var n=c('ShortProfiles').getNow(m);return m==c('CurrentUser').getID()||n&&(n.type===c('MercuryParticipantTypes').FRIEND||n.type===c('MercuryParticipantTypes').FB4C);});return l;};j.prototype.isBootstrapped=function(){'use strict';return this.$MercuryAudienceRestrictedTypeaheadDataSource1;};j.prototype.isBootstrapping=function(){'use strict';return this.$MercuryAudienceRestrictedTypeaheadDataSource2;};j.prototype.processEntries=function(k,l){'use strict';k=k&&k.map(function(m){if(m.index==null&&(m.render_type===c('MercuryParticipantTypes').FRIEND||m.render_type===c('MercuryParticipantTypes').FB4C))m.index=c('OrderedFriendsList').getActiveRank(m.uid);return m;});return i.processEntries.call(this,k);};j.prototype.mergeUids=function(k,l,m,n){'use strict';var o=l.sort(function(p,q){var r=this.getEntry(p),s=this.getEntry(q);return r&&r.index&&s&&s.index?r.index-s.index:0;}.bind(this));return i.mergeUids.call(this,k,o,m,n);};j.prototype.setQueryData=function(k,l){'use strict';return i.setQueryData.call(this,k);};j.prototype.respond=function(k,l,m){'use strict';return i.respond.call(this,k,l,m);};j.prototype.setShowThreads=function(k){'use strict';this.$MercuryAudienceRestrictedTypeaheadDataSource4=k;};f.exports=j;}),null);
__d('XAsyncRequest',['AsyncRequest'],(function a(b,c,d,e,f,g){function h(i){'use strict';this.$XAsyncRequest1=new (c('AsyncRequest'))(i);}h.prototype.setMethod=function(i){'use strict';this.$XAsyncRequest1.setMethod(i);return this;};h.prototype.setData=function(i){'use strict';this.$XAsyncRequest1.setData(i);return this;};h.prototype.setHandler=function(i){'use strict';this.$XAsyncRequest1.setHandler(i);return this;};h.prototype.setErrorHandler=function(i){'use strict';this.$XAsyncRequest1.setErrorHandler(i);return this;};h.prototype.send=function(){'use strict';this.$XAsyncRequest1.send();return this;};h.prototype.abort=function(){'use strict';this.$XAsyncRequest1.abort();};f.exports=h;}),null);
__d('NotificationJewelReminderLoader',['JSResource'],(function a(b,c,d,e,f,g){f.exports={init:function h(i){c('JSResource')('NotificationJewelReminder').__setRef('NotificationJewelReminderLoader').load().done(function(j){new j(i);});}};}),null);
__d('legacy:CompactTypeaheadRenderer',['CompactTypeaheadRenderer'],(function a(b,c,d,e,f,g){if(!b.TypeaheadRenderers)b.TypeaheadRenderers={};b.TypeaheadRenderers.compact=c('CompactTypeaheadRenderer');}),3);
__d('StoreAndPropBasedStateMixin',['invariant','StoreBasedStateMixinHelper','setImmediate'],(function a(b,c,d,e,f,g,h){'use strict';var i=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];return {getInitialState:function m(){return this.constructor.calculateState(this.props);},componentWillMount:function m(){this.constructor.calculateState||h(0);this._recalculateStateID=null;var n=function(){if(this.isMounted())this.setState(this.constructor.calculateState(this.props));this._recalculateStateID=null;}.bind(this);this._mixin=new (c('StoreBasedStateMixinHelper'))(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=c('setImmediate')(n);}.bind(this));},componentWillReceiveProps:function m(n){this.setState(this.constructor.calculateState(n));},componentWillUnmount:function m(){this._mixin.release();this._mixin=null;}};}.bind(this);f.exports=i;}),null);
__d('QE',['Banzai','Cache'],(function a(b,c,d,e,f,g){var h='qe_log_exposure',i=60,j=new (c('Cache'))(),k={logExposure:function l(m,n){var o=n?m+'|'+n:m;if(j.has(o))return;var p={signal:true},q={name:m,id:null};if(n)q.id=n;c('Banzai').post(h,q,p);j.set(o,true,1,i);}};f.exports=k;}),null);
__d("XQuickPromotionSimpleLoggingController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("\/qp\/action\/log\/",{qp_id:{type:"Int",required:true},qp_action:{type:"Enum",enumType:1},qp_instance_log_data:{type:"StringToStringMap",defaultValue:{}},qp_event:{type:"String"}});}),null);